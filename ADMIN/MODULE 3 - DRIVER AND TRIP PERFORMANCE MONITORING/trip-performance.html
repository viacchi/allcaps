<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Trip Performance Reports - Logistics II</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="icon" href="data:,">
  <!-- Leaflet CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <!-- Leaflet JS -->
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <style>
    #map { height: 300px; border-radius: 0.5rem; }
  </style>
</head>
<body class="bg-gray-100 text-gray-800 min-h-screen">

  <!-- Trip Performance Reports Header -->
  <main class="pt-20 px-6 w-full max-w-7xl mx-auto">
    <div class="w-full px-6 py-6">
      <header class="mb-4 text-center"> 
        <h1 class="text-2xl font-semibold">Trip Performance Reports</h1>
        <p class="text-gray-600 mt-1">
          Provides detailed records and performance metrics of completed trips
        </p>
      </header>
    </div>
  </main>

  <!-- Fleet Tracking Panel -->
  <div class="flex justify-between items-center px-6 py-4 bg-white shadow">
    <div>
      <h1 class="text-2xl font-bold">Fleet Tracking Panel</h1>
      <p class="text-sm text-gray-500">
        Real-time map of fleet positions and driver locations
      </p>
    </div>
    <div class="flex items-center space-x-6">
      <button onclick="refreshData()" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">
        Refresh
      </button>
      <p class="text-sm text-gray-500">
        Last updated: <span id="lastUpdated">--:--:--</span>
      </p>
    </div>
  </div>

  <!-- Summary Cards -->
  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 p-6">
    <!-- Total Vehicles -->
    <div class="bg-white rounded-lg shadow p-6 flex items-center justify-between">
      <div>
        <h2 class="text-lg font-semibold">Total Vehicles</h2>
        <p id="totalVehicles" class="text-2xl font-bold mt-2 text-black">0</p>
      </div>
      <div class="text-black-500">
       <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-10 h-10">
        <path stroke-linecap="round" stroke-linejoin="round" d="M15 10.5a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" />
        <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1 1 15 0Z" />
      </svg>
      </div>
    </div>

    <!-- On Trip -->
    <div class="bg-white rounded-lg shadow p-6 flex items-center justify-between">
      <div>
        <h2 class="text-lg font-semibold">On Trip</h2>
        <p id="onTrip" class="text-2xl font-bold mt-2 text-green-600">0</p>
      </div>
      <div class="text-green-600">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-10 h-10">
          <path stroke-linecap="round" stroke-linejoin="round" d="M6 12 3.269 3.125A59.769 59.769 0 0 1 21.485 12 59.768 59.768 0 0 1 3.27 20.875L5.999 12Zm0 0h7.5" />
        </svg>
      </div>
    </div>

    <!-- Idle -->
    <div class="bg-white rounded-lg shadow p-6 flex items-center justify-between">
      <div>
        <h2 class="text-lg font-semibold">Idle</h2>
        <p id="idle" class="text-2xl font-bold mt-2 text-blue-600">0</p>
      </div>
      <div class="text-blue-600">
        <!-- Clock Icon -->
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
             stroke-width="1.5" stroke="currentColor" class="w-10 h-10">
          <path stroke-linecap="round" stroke-linejoin="round"
                d="M12 6v6h4.5M12 3a9 9 0 110 18 9 9 0 010-18z" />
        </svg>
      </div>
    </div>

    <!-- Maintenance -->
    <div class="bg-white rounded-lg shadow p-6 flex items-center justify-between">
      <div>
        <h2 class="text-lg font-semibold">Maintenance</h2>
        <p id="maintenance" class="text-2xl font-bold mt-2 text-yellow-600">0</p>
      </div>
      <div class="text-yellow-600">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
             stroke-width="1.5" stroke="currentColor" class="w-10 h-10">
          <path stroke-linecap="round" stroke-linejoin="round"
                d="M12 9v3.75M12 15.75h.01M21 19.5H3L12 3l9 16.5z" />
        </svg>
      </div>
    </div>
  </div>

  <!-- Main Content -->
  <div class="grid grid-cols-3 gap-6 px-6 pb-6">
    <!-- Map Section -->
    <div class="col-span-2 bg-white rounded-lg shadow p-6">
      <div class="flex justify-between items-center mb-4">
        <h2 class="font-semibold">Live Fleet Map</h2>
        <select id="filterStatus" class="border rounded px-2 py-1 text-sm">
          <option value="all">All Status</option>
          <option value="On Trip">On Trip</option>
          <option value="Idle">Idle</option>
          <option value="Maintenance">Maintenance</option>
        </select>
      </div>
      <div id="map"></div>
    </div>

    <!-- Vehicle Status -->
    <div class="bg-white rounded-lg shadow p-6 overflow-y-auto max-h-[400px]">
      <h2 class="font-semibold mb-4">Vehicle Status</h2>
      <div id="vehicleList"></div>
    </div>
  </div>

   <div class="flex justify-end mt-2">
      <a href="admin.html"
         class="px-4 py-2  bg-red-600 text-white rounded-lg hover:bg-red-700">
        Exit
      </a>
    </div>

  <script>
    // Vehicle Data
    const vehicles = [
      {
        id: "ABC-123",
        model: "Toyota Camry",
        driver: "John Martinez",
        location: "Manila, Philippines",
        lat: 14.5995, lng: 120.9842,
        speed: "45 km/h",
        route: "Route A -> Warehouse B",
        battery: "78%",
        status: "On Trip",
        updated: "2 minutes ago"
      },
      {
        id: "XYZ-789",
        model: "Ford Transit",
        driver: "Sarah Chen",
        location: "Quezon City, Philippines",
        lat: 14.6760, lng: 121.0437,
        speed: "50 km/h",
        route: "Warehouse B -> Main Deport",
        battery: "92%",
        status: "Idle",
        updated: "5 minutes ago"
      },
      {
        id: "DEF-456",
        model: "Volvo FH16",
        driver: "John Martinez",
        location: "Cebu City, Philippines",
        lat: 10.3157, lng: 123.8854,
        speed: "55km/h",
        route: "Route B -> Warehouse A",
        battery: "54%",
        status: "Maintenance",
        updated: "10 minutes ago"
      }
    ];

    // Icons for status
    const statusIcons = {
      "On Trip": `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 text-green-600 inline-block mr-1">
          <path stroke-linecap="round" stroke-linejoin="round" d="M6 12 3.269 3.125A59.769 59.769 0 0 1 21.485 12 59.768 59.768 0 0 1 3.27 20.875L5.999 12Zm0 0h7.5" />
        </svg>`,
      "Idle": `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 text-blue-600 inline-block mr-1">
          <path stroke-linecap="round" stroke-linejoin="round"
                d="M12 6v6h4.5M12 3a9 9 0 110 18 9 9 0 010-18z" />
        </svg>`,
      "Maintenance": `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
             stroke-width="1.5" stroke="currentColor" class="w-5 h-5 text-yellow-600 inline-block mr-1">
          <path stroke-linecap="round" stroke-linejoin="round"
                d="M12 9v3.75M12 15.75h.01M21 19.5H3L12 3l9 16.5z" />
        </svg>`
    };

    // Init Map (Philippines center: Manila)
    const map = L.map('map').setView([12.8797, 121.7740], 6);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '&copy; OpenStreetMap contributors'
    }).addTo(map);

    let markers = [];

    function renderVehicles(filter = "all") {
      const vehicleList = document.getElementById("vehicleList");
      vehicleList.innerHTML = "";
      markers.forEach(m => map.removeLayer(m));
      markers = [];

      const filtered = vehicles.filter(v => filter === "all" || v.status === filter);

      // Update Stats
      document.getElementById("totalVehicles").innerText = vehicles.length;
      document.getElementById("onTrip").innerText = vehicles.filter(v => v.status === "On Trip").length;
      document.getElementById("idle").innerText = vehicles.filter(v => v.status === "Idle").length;
      document.getElementById("maintenance").innerText = vehicles.filter(v => v.status === "Maintenance").length;

      filtered.forEach(v => {
        const div = document.createElement("div");
        div.className = "border-b pb-3 mb-3";
        div.innerHTML = `
          <p class="font-semibold flex items-center gap-2">
            ${statusIcons[v.status] || ""} ${v.id}
            <span class="ml-2 px-2 py-0.5 text-lg rounded-full ${
              v.status === "On Trip" ? "bg-green-100 text-green-600" :
              v.status === "Idle" ? "bg-blue-100 text-blue-600" :
              "bg-yellow-100 text-yellow-600"
            }">${v.status}</span>
          </p>
          <p class="text-lg text-gray-600">${v.model}</p>
          <p class="text-lg text-gray-600">Driver: ${v.driver}</p>
          <p class="text-lg text-gray-500">${v.location}</p>
          <p class="text-lg text-gray-500">Route: ${v.route}</p>
          <p class="text-lg flex items-center gap-2">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
            stroke="currentColor" class="w-4 h-4 text-yellow-500 ml-2">
            <path stroke-linecap="round" stroke-linejoin="round"
            d="m3.75 13.5 10.5-11.25L12 10.5h8.25L9.75 21.75 12 13.5H3.75Z" />
            </svg>
            ${v.speed}
            
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4 text-green-500 ml-2">
              <path stroke-linecap="round" stroke-linejoin="round"
              d="M21 10.5h.375c.621 0 1.125.504 1.125 1.125v2.25c0 .621-.504 1.125-1.125 1.125H21M3.75 18h15A2.25 2.25 0 0 0 21 15.75v-6a2.25 2.25 0 0 0-2.25-2.25h-15A2.25 2.25 0 0 0 1.5 9.75v6A2.25 2.25 0 0 0 3.75 18Z" />
              </svg>
              ${v.battery}
          </p>
          <p class="text-lg text-gray-400">Updated: ${v.updated}</p>
        `;
        vehicleList.appendChild(div);

        const marker = L.marker([v.lat, v.lng])
          .addTo(map)
          .bindPopup(`<b>${v.id}</b><br>${v.driver}<br>${v.status}`);
        markers.push(marker);
      });
    }

    function refreshData() {
      const now = new Date();
      document.getElementById("lastUpdated").innerText = now.toLocaleTimeString();
      renderVehicles(document.getElementById("filterStatus").value);
    }

    document.getElementById("filterStatus").addEventListener("change", (e) => {
      renderVehicles(e.target.value);
    });

    refreshData();
  </script>

</body>
</html>
